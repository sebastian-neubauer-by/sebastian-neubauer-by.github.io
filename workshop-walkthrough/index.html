
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.3.0, mkdocs-material-8.2.13" name="generator"/>
<title>Workshop Walkthrough - DevCon Workshop 2022</title>
<link href="../assets/stylesheets/main.e411adfe.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.cc9b2e1e.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="none" data-md-color-primary="none" data-md-color-scheme="" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#the-developer-portal">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="DevCon Workshop 2022" class="md-header__button md-logo" data-md-component="logo" href=".." title="DevCon Workshop 2022">
<img alt="logo" src="../Blue_Yonder_rgb.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            DevCon Workshop 2022
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Workshop Walkthrough
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="..">
      Registration
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../story/">
      The Story
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="./">
      Workshop Walkthrough
    </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="DevCon Workshop 2022" class="md-nav__button md-logo" data-md-component="logo" href=".." title="DevCon Workshop 2022">
<img alt="logo" src="../Blue_Yonder_rgb.png"/>
</a>
    DevCon Workshop 2022
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        Registration
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../story/">
        The Story
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Workshop Walkthrough
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Workshop Walkthrough
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#login">
    Login
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
    Introduction
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#navigate-the-portal">
    Navigate the portal
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-api-catalog">
    The API Catalog
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#create-liam-m2m-client">
    Create LIAM m2m client
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#building-the-workflow">
    Building the Workflow
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#from-low-code-to-pro-code">
    From Low-Code to Pro-Code
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-save-publish-run-check-cycle">
    The Save, Publish, Run, Check Cycle
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#developing-our-first-own-action">
    Developing our first own action
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-foreach-loop">
    The Foreach Loop
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="the-developer-portal"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.</span> The developer Portal</h1>
<h2 id="login"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.1</span> Login</h2>
<p>First we login into the developer portal:</p>
<p><a href="https://bylumuiportalplpna.azureedge.net/home/" target="_blank">https://bylumuiportalplpna.azureedge.net/home/</a></p>
<p>You need to enter the realm, which is <code>by-developer</code> for the developer portal.</p>
<p>Then login with your account credentials.</p>
<h2 id="introduction"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.2</span> Introduction</h2>
<p>A very brief overview of what we are going to build in this workshop.</p>
<p>We are using the Luminate Platform service "Workflow" to call the LDE Prediction Overrides API. 
We will configure that workflow to be executed periodically every minute.
With the returned prediction overrides, we are going to implement a filter on prediction overrides which are created 
not longer than a minute ago. 
As the workflow runs every minute, we therefore get exclusively the newly created prediction overrides. 
For each new prediction override we then create an exception in the Luminate Platform Exception Service.</p>
<p>That's it, easy, right?</p>
<h2 id="navigate-the-portal"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.3</span> Navigate the portal</h2>
<figure>
<p><img align="left" alt="Image title" src="../images/devportal_dashboard.png">
</img></p>
<figcaption>After login you see the dashboard</figcaption>
</figure>
<p>For now we are only interested in the "App Gallery" whoch shows all services and application that you have access to.</p>
<figure>
<p><img align="left" alt="Image title" src="../images/devportal_app-gallery_marked.png">
</img></p>
<figcaption>The App Gallery view</figcaption>
</figure>
<h2 id="the-api-catalog"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.4</span> The API Catalog</h2>
<p>We now want to find out if there are APIs we can use to build our notification feature.
For this we launch the API Catalog in the API Gallery</p>
<figure>
<p><img align="left" alt="Image title" src="../images/devportal_apicatalog.png"/>
</p>
<figcaption>Launch the API Catalog</figcaption>
</figure>
<p>Inside the API Catalog, search for LDE. You then will find all the API exposed by LDE for you.
You should find the "Blue Yonder LDE Prediction Overrides v1" API and click on it.</p>
<figure>
<p><img align="left" alt="Image title" src="../images/devportal_apicatalog_overrides.png"/>
</p>
<figcaption>Finding the LDE Prediction Overrides API in the API Catalog</figcaption>
</figure>
<p>Once you clicked on it, you will be navigated to the API documentation.</p>
<figure>
<p><img align="left" alt="Image title" src="../images/LDE_api_doc_tryout.png"/>
</p>
<figcaption>Documentation of the LDE Prediction Overrides API</figcaption>
</figure>
<p>Here you can try our an API call by first clicking on the "Try it out" button
and subsequently on the "Execute" button.</p>
<figure>
<p><img align="left" alt="Image title" src="../images/LDE_api_doc_execute.png"/>
</p>
<figcaption>You can try the API by clicking on "Execute"</figcaption>
</figure>
<p>By executing this GET request we will get a list of all prediction overrides stored in the LDE instance.</p>
<figure>
<p><img align="left" alt="Image title" src="../images/PredcitionOverrides_docs_response.png"/>
</p>
<figcaption>Hey, we have a list of all prediction overrides stored in the LDE instance!</figcaption>
</figure>
<p>The response should look like this</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"processing_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FINISHED"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"override_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6caccdf4-eeef-4fb7-83b6-6e96b334719b"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"override_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"create"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"mode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"workbench"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"product_column_name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"location_column_name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"value_column_name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"></span>
<span class="hll"><span class="w">    </span><span class="nt">"creation_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-04-25T22:17:22.563620+00:00"</span><span class="p">,</span><span class="w"></span>
</span><span class="w">    </span><span class="nt">"is_active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"desired_is_active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"last_update"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-04-25T22:17:30.766706+00:00"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"creation_user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"someone@youdelivers.com"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"last_updated_user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"someone@youdelivers.com"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">"other"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"min_affected_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-04-28"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"max_affected_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-05-17"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"number_clp_combination"</span><span class="p">:</span><span class="w"> </span><span class="mi">273</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"number_rows"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"lde-ui"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"prediction_accuracy"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"override_accuracy"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="err">...</span><span class="w"></span>
<span class="p">]</span><span class="w"></span>
</code></pre></div>
<p>For our purpose, we are only interested in the <code>creation_time</code> value. But just 
look what's there, endless possibilities for cool new features, right?</p>
<h2 id="create-liam-m2m-client"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5</span> Create LIAM m2m client</h2>
<p>Luminate Identy Access Management (LIAM) is the authentication and authorization 
service in the Luminate Platform. </p>
<p>You are already logged in into the portal, so your identity is known to all services.
But when we want to build a service accessing API's, it is not you accessing the APIs, but this service.</p>
<p>This is what machine-to-machine clients (m2m client) are for in LIAM. So we can create new identities that we
assign to services and give it any subset of roles and permissions that our own identy has.</p>
<p>This is increasing security dramatically, as we can shape those permissions such that it is "just enough" to do the job.
Through the "scope" we can limit which services can be accessed, so that even if this m2m client is leaked, it
cannot be used for anything else that the anticipated use-case.</p>
<p>We pre-created one such m2m client. In a production setting we would share the client_secret via Azure Key Vaults or 
some other secure secrets sharing mechanism. For the sake of simplicity, we use a poor-mans out-of-band second-factor secret sharing. 
Replace the first 4 <code>_</code> with the 4 characters on the slides</p>
<div class="highlight"><pre><span></span><code>____Q~pR26qXQ8qFgAa552NbVzBwwV1F4FJ1oaz8
</code></pre></div>
<p>Alternatively, in the "DevCon22 Workshop" application in ALM, there is a module called "shared m2m client" and in there 
is a workflow called "shared m2m client secret". If you enter the workflow editor for this workflow, cou can copy&amp;paste 
the m2m client credentials from there. You learn how to access and do all that in the next section.</p>
<h2 id="building-the-workflow"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.6</span> Building the Workflow</h2>
<p>Now we now there is an API there is an API we have a m2m client to be able to access this API.
Now we need something to actually call the API and trigger actions based on the results.
That is exactly what the "Workflow" feature is for. </p>
<div class="admonition info">
<p class="admonition-title">Workflow in a nutshell</p>
<p>Workflow is based on the Azure Logic Apps service. Using a domain specific language (DSL) based on json one can easily 
define workflows that connect all kinds of APIs, services and events. The documentation of the Azure Logic Apps DSL can 
be found <a href="https://docs.microsoft.com/en-us/azure/logic-apps/logic-apps-workflow-definition-language">here</a>.</p>
<p>We will make use of the DSL, but also use the no-code visual workflow editor in the Luminate Portal.</p>
</div>
<figure>
<p><img align="left" alt="Image title" src="../images/devportal_startALM.png"/>
</p>
<figcaption>Start the ALM application in the app gallery</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">ALM in a nutshell</p>
<p>The Application Lifecycle Management service (ALM) lets you create and maintain the lifecycle of applications you 
create on the Luminate Platform. An application consists of multiple modules, and each module consists of 
several resources. In our case, the only available resource type is Workflow. We have one application for our 
workshop and every participant will create their own module in which they can build one or more workflows.</p>
</div>
<figure>
<p><img align="left" alt="Image title" src="../images/ALMStudio_application_overview_marked.png"/>
</p>
<figcaption>Click on the DevCon22 Workshop application</figcaption>
</figure>
<figure>
<p><img align="left" alt="Image title" src="../images/ALMStudio_add_module_marked.png"/>
</p>
<figcaption>In the module list overview of the DevCon 22 Workshop click on "Add Module"</figcaption>
</figure>
<figure>
<p><img align="left" alt="Image title" src="../images/ALMStudio_create_module_name.png"/>
</p>
<figcaption>As every participant creates their own module, let's include our name in the module name, why not YOURNAME-workshop</figcaption>
</figure>
<figure>
<p><img align="left" alt="Image title" src="../images/ALMStudio_create_module_create.png"/>
</p>
<figcaption>Here you can leave everything like it is and just click on "Create Module"</figcaption>
</figure>
<figure>
<p><img align="left" alt="Image title" src="../images/ALMStudio_create_module_created_marked.png"/>
</p>
<figcaption>Now click on your newly created module</figcaption>
</figure>
<figure>
<p><img align="left" alt="Image title" src="../images/ALMStudio_add_resource_workflow_marked.png"/>
</p>
<figcaption>As your module is brand-new it should be quite empty, so let's click on "Add resource" and select "Workflow" as the resource type</figcaption>
</figure>
<figure>
<p><img align="left" alt="Image title" src="../images/ALMStudio_add_resource_workflow_template.png"/>
</p>
<figcaption>Here you have to select a template which your workflow will be based on. It happens that "LIAM M2M Authentication" is a quite good starting point for our workshop...we are really lucky!</figcaption>
</figure>
<figure>
<p><img align="left" alt="Image title" src="../images/ALMStudio_add_resource_workflow_name.png"/>
</p>
<figcaption>Oh gosh, we have to choose another name, I thought maybe "prediction_overrides_workflow" is a pretty good one.</figcaption>
</figure>
<figure>
<p><img align="left" alt="Image title" src="../images/ALMStudio_add_resource_workflow_created_marked.png"/>
</p>
<figcaption>Hey, our workflow should be created, let's jump right into the implementation and hit the edit icon!</figcaption>
</figure>
<h2 id="from-low-code-to-pro-code"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.7</span> From Low-Code to Pro-Code</h2>
<div class="admonition info">
<p class="admonition-title">Low-Code &lt;&gt; Pro-Code</p>
<p>There is a low-code representation of your workflow, but there you have only limited customizability. 
So you will often have to switch between the low-code editor, and the pro-code editor. You can either enter the 
pro-code of the full workflow, or just the pro-code representation of a single node. In this section you will 
learn how to jump between those.</p>
</div>
<figure>
<p><img align="left" alt="Image title" src="../images/WorkflowEditor_template.png"/>
</p>
<figcaption>Once you are in the low-code editor you should see the template which is just one HTTP action.</figcaption>
</figure>
<figure>
<p><img align="left" alt="Image title" src="../images/WorkflowEditor_global_switchprocode_marked.png"/>
</p>
<figcaption>When no node is selected (click on the white background), "Switch to Pro-Code" brings you to the pro-code representation of the global workflow.</figcaption>
</figure>
<figure>
<p><img align="left" alt="Image title" src="../images/WorkflowEditor_global_procode_marked.png"/>
</p>
<figcaption>"Switch to Workflow editor" brings you back to the low-code representation.</figcaption>
</figure>
<figure>
<p><img align="left" alt="Image title" src="../images/WorkflowEditor_node_switchprocode.png"/>
</p>
<figcaption>If you select a node (notice the "Action Properties" window in the top right) "Switch to Pro-Code" brings you to the pro-code representation of only the selected node.</figcaption>
</figure>
<figure>
<p><img align="left" alt="Image title" src="../images/WorkflowEditor_node_procode.png"/>
</p>
<figcaption>And "Switch to Workflow Editor" brings you back.</figcaption>
</figure>
<p>Now you know everything about low-code, pro-code. If you just stay in the pro-code representation, I will not hate you ;-)</p>
<h2 id="the-save-publish-run-check-cycle"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.8</span> The Save, Publish, Run, Check Cycle</h2>
<p>In this section we learn how we do the usual development cycle: change something, run it, check if the results are as 
expected (which barely ever is the case, right?)</p>
<figure>
<p><img align="left" alt="Image title" src="../images/WorkflowEditor_template_cycle.png"/>
</p>
<figcaption>The development cyle is 1) Save 2) Publish 3) Run 4) Open Run History.</figcaption>
</figure>
<p>If we do the cycle with the template we should see a failed first run.</p>
<figure>
<p><img align="left" alt="Image title" src="../images/WorkflowEditor_failedrun_marked.png"/>
</p>
<figcaption>Surprise, the result is not quite what we expected, the run failed. Maybe you spot what might be wrong. Click on "Close" to go back to the workflow editor.</figcaption>
</figure>
<figure>
<p><img align="left" alt="Image title" src="../images/WorkflowEditor_addm2m_cred_marked.png"/>
</p>
<figcaption>Sure, we haven't entered the credentials from our m2m client yet. Let's do that and do the cycle. (Don't forget to hit "Save Changes" before.)</figcaption>
</figure>
<figure>
<p><img align="left" alt="Image title" src="../images/WorkflowEditor_getLIAMToken_suceeded.png"/>
</p>
<figcaption>Nice!</figcaption>
</figure>
<p>We just debugged our workflow template! We are now ready for new challenges!</p>
<h2 id="developing-our-first-own-action"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.9</span> Developing our first own action</h2>
<p>Time to develop our first own action. Now that we have the LIAM token, we can authenticate to the any Blue yonder API. 
So let's call the LDE Overrides API!</p>
<p>Hit the plus sign after the "Get LIAM Token" and select "Http".</p>
<figure>
<p><img align="left" alt="Image title" src="../images/WorkflowEditor_rename_httpaction_marked.png"/>
</p>
<figcaption>Now we have a new Http action and rename it to Get Prediction Overrides.</figcaption>
</figure>
<figure>
<p><img align="left" alt="Image title" src="../images/WorkflowEditor_empty_httpaction.png"/>
</p>
<figcaption>In the pro-code view, we see it is empty, let's fill it with the right content!</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">How to use results from previous actions</p>
<p>If you want to use results from previous actions, you can access them with <code>body('NAME OF THE ACTION')</code>, as everything
in Workflow is json, you can easily access values from the json body using <code>body('NAME OF THE ACTION')?['KEY']</code> and 
finally, if we want to actually return the value (as a string), we use the <code>@</code> operator.<br/>
So, this should return the key 'KEY' of the result of the 'NAME OF THE ACTION' action as as tring which can be directly embedded in another string:</p>
<p><code>"Hello @{body('NAME OF THE ACTION')?['KEY']}"</code></p>
<p>For more details, please have a look at the Azure Logic Apps Workflow Definition Language <a href="https://docs.microsoft.com/en-us/azure/logic-apps/logic-apps-workflow-definition-language#expressions">documentation</a></p>
</div>
<p>This is how the empty HTTP action looks like:</p>
<p><div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Http"</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"inputs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"Get LIAM Token"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"Succeeded"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
Now, if we remember LDE Predictions Overrides API documentation in the 
API Catalog we saw that the request to get a list of predictions looks like this.
If you don't have a photographic memory, here is what we saw there: </p>
<div class="highlight"><pre><span></span><code>curl -X <span class="s1">'GET'</span> <span class="se">\</span>
  <span class="s1">'https://api.jdadelivers.com/lde/prediction-overrides/v1/overrides'</span> <span class="se">\</span>
  -H <span class="s1">'accept: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'Authorization: Bearer eyJ0eXAiOiJKV1QiLCJh********'</span>
</code></pre></div>
<p>So, the "method" seems to be "GET" and we can just enter it in the pro-code json.
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Http"</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"inputs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://"</span><span class="p">,</span><span class="w"></span>
<span class="hll"><span class="w">    </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w"></span>
</span><span class="w">    </span><span class="nt">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"Get LIAM Token"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"Succeeded"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
Can you figure out the rest? </p>
<p>Sure! I help you a bit, the url we can again just copy&amp;paste. For the "headers" we need to add some double quotes and 
commas to get it proper json, can you do that?</p>
<details class="warning">
<summary>this is how the "headers" should look like</summary>
<div class="highlight"><pre><span></span><code><span class="nt">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"accept"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"Authorization"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer eyJ0eXAiOiJKV1QiLCJh********"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</details>
<p>Now, The "Bearer" token seems to be a bit tricky, isn't it? The actual token should not be that static string, but the 
LIAM token we created in the previous action 'Get LIAM Token'. 
It seems we need to embed a string from the result of a previous action, if only we would know how this works...</p>
<details class="warning">
<summary>If you want to cheat, solution is in here</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Http"</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"inputs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.jdadelivers.com/lde/prediction-overrides/v1/overrides"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">"accept"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">"Authorization"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer @{body('Get LIAM Token')?['access_token']}"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"Get LIAM Token"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"Succeeded"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</details>
<p>If you came that far, just "Save, Publish, Run" and check the latest run if it succeded. </p>
<p>It succeeded? Great! But there are a lot of prediction overrides right, and they are all outdated which is quite 
inconvenient because they clutter the results.</p>
<p>But wasn't there a parameter in the api documentation to restrict the result to only prediction overrides created after 
some date?</p>
<p>Can you figure that out and restrict the results to only overrides from yesterday?</p>
<details class="hint">
<summary>Hint</summary>
<p>Just check the LDE Overrides Prediction API doc and figure our how the url in the curl command changes when you add the "minAffectedDate"</p>
</details>
<p>You think you got it? "Save, Publish, Run" and check the result! How many overrides do you have now in the response?</p>
<details class="warning">
<summary>Look behind you, a Three-Headed Monkey! (full solution in here)</summary>
<p>If you fail to get the json right, just copy&amp;paste. This should work: 
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Http"</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"inputs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.jdadelivers.com/lde/prediction-overrides/v1/overrides?minAffectedDate=2022-05-15"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">"accept"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">"Authorization"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer @{body('Get LIAM Token')?['access_token']}"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"Get LIAM Token"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"Succeeded"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div></p>
</details>
<h2 id="the-foreach-loop"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.10</span> The Foreach Loop</h2>
<p>Now we have a list of all recent overrides predictions, but we are only interested in the newly created overrides 
predictions since the last run of the workflow.</p>
<p>For this, the idea is to loop over all entries in the result of the previous HTTP action and filter for those entries, 
where the creation timestamp is greater than the last run of the workflow. </p>
<p>We will later on trigger the workflow periodically every minute. So the timestamp should be greater then the current 
time 1 minute ago.</p>
<p>Lets start with the loop over all entries.</p>
<p>Just hit the plus sign after the "Get Prediction Overrides" action and select "Foreach" (see <a href="https://docs.microsoft.com/en-us/azure/logic-apps/logic-apps-workflow-actions-triggers#foreach-action">documentation</a>).</p>
<p>Let's rename it to "Process Prediction Overrides".</p>
<figure>
<p><img align="left" alt="Image title" src="../images/WorkflowEditor_foreach_empty.png"/>
</p>
<figcaption>Again pretty empty inside. Let's figure it out!</figcaption>
</figure>
<p>So, this is how the structure looks like. 
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Foreach"</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="hll"><span class="w">    </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span class="hll"><span class="w">      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"></span>
</span><span class="hll"><span class="w">      </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
</span><span class="hll"><span class="w">    </span><span class="p">}</span><span class="w"></span>
</span><span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">"foreach"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"Get Prediction Overrides"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"Succeeded"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div></p>
<p>First we need to delete the empty action, otherwise the parser will complain.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Foreach"</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">"foreach"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"Get Prediction Overrides"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"Succeeded"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Do you notice the foreach key? </p>
<p><div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Foreach"</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">"foreach"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"Get Prediction Overrides"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"Succeeded"</span><span class="w"></span>
<span class="hll"><span class="w">    </span><span class="p">]</span><span class="w"></span>
</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
The "foreach" key takes a list as a value...as the result of the previous action was a list of prediction overrides...
maybe this works as before? (@ .. body... do you remember?). Try it out.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>This is a hard one to figure out: Curly braces <code>{}</code> convert the data to a string. 
If you do not want to have a string, but the original data structure, you need to leave out the curly braces <code>{}</code>.
Hey, don't worry, took me several days to figure that out ;-) (see "String interpolation" in the <a href="https://docs.microsoft.com/en-us/azure/logic-apps/logic-apps-workflow-definition-language#expressions">documentation</a>)</p>
</div>
<details class="warning">
<summary>No, I don't get it, show me</summary>
<p>Pretty simple if you know how to do it.
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Foreach"</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"></span>
<span class="w">  </span><span class="nt">"foreach"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@body('Get Prediction Overrides')"</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"Get Prediction Overrides"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"Succeeded"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div></p>
</details>
<figure>
<p><img align="left" alt="Image title" src="../images/WorkflowEditor_foreach_runstats_dummy.png"/>
</p>
<figcaption>If all goes well, we should see a dummy iteration doing nothing for every prediction override.</figcaption>
</figure>
<p>Now, let's add some actions that are executed in every iteration over all prediction overrides.</p>
<p>As a reminder: Based on a "if" condition (timestamp &gt; current time - 1 minute) we want to create an exception in the 
exception service.</p>
<p>Lets start with the "if" condition. In order to see the empty structure of a condition, we do a trick. As nested structures 
("If" inside "Foreach" loop) is not supported by the low-code representation currently,<br/>
we just add a dummy condition, copy the pro-code json of it and delete it again.</p>
<p>Now we can remove the "else" entry and empty the "runAfter" field (as it will run inside a loop).</p>
<p>You can of course also refer to the <a href="https://docs.microsoft.com/en-us/azure/logic-apps/logic-apps-workflow-actions-triggers#if-action">documentation</a></p>
<p>Or, you just copy it from here, there is no shame, as admittedly this is quite cumbersome:</p>
<p><div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Foreach"</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="hll"><span class="w">    </span><span class="nt">"Our_filter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</span><span class="hll"><span class="w">      </span><span class="nt">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"></span>
</span><span class="hll"><span class="w">      </span><span class="nt">"expression"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"></span>
</span><span class="hll"><span class="w">      </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"></span>
</span><span class="hll"><span class="w">      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"If"</span><span class="w"></span>
</span><span class="hll"><span class="w">    </span><span class="p">}</span><span class="w"></span>
</span><span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">"foreach"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@body('Get Prediction Overrides')"</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"Get Prediction Overrides"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"Succeeded"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
So, we added a new action in the empty actions section and called it "Our_Filter". The parser will complain, as the 
expression secton must not be empty, so we have to fill it...remember (timestamp &gt; current time - 1 minute)?</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Inside a foreach loop, you have access to the data of the current entity with the "item" keyword. As nested loops 
are possible, you need to pass it the name of the foreach loop. </p>
</div>
<p>But this time I have to help you, because of our limited time and without reading the documentation of the Azure 
Logic Apps documentation and experimenting a lot, this is impossible to guess. (see <a href="https://docs.microsoft.com/en-us/azure/logic-apps/logic-apps-workflow-actions-triggers#how-conditions-use-expressions">documentation</a>)</p>
<p>So this is the expression:</p>
<p><div class="highlight"><pre><span></span><code><span class="w">        </span><span class="nt">"and"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">          </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">"greater"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">              </span><span class="s2">"@{ticks(items('Loop')['creation_time'])}"</span><span class="p">,</span><span class="w"></span>
<span class="w">              </span><span class="s2">"@{ticks(getPastTime(1, 'Minute'))}"</span><span class="w"></span>
<span class="w">            </span><span class="p">]</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">]</span><span class="w"></span>
</code></pre></div>
Not exactly intuitive, right? And maybe I did a tiny bug in this expression...
So insert it in our condition inside the loop and debug!</p>
<details class="warning">
<summary>You tried very hard, I know...</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Foreach"</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"Our_filter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"></span>
<span class="w">      </span><span class="nt">"expression"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">"and"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">          </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">"greater"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">              </span><span class="s2">"@{ticks(items('Process Prediction Overrides')['creation_time'])}"</span><span class="p">,</span><span class="w"></span>
<span class="w">              </span><span class="s2">"@{ticks(getPastTime(1, 'Minute'))}"</span><span class="w"></span>
<span class="w">            </span><span class="p">]</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">]</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"></span>
<span class="w">      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"If"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">"foreach"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@body('Get Prediction Overrides')"</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"Get Prediction Overrides"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"Succeeded"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</details>
<figure>
<p><img align="left" alt="Image title" src="../images/WorkflowEditor_foreach_runstats_if.png"/>
</p>
<figcaption>In the runstats you should now see the expression result.</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">Can you tweak the getPastTime in a way that the expression turns to true?</p>
<p>Might help for debugging...</p>
</div>
<p>So we are nearly there!</p>
<p>All we need is a Http if the expression is true to create an exception in the Exception Service.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The API spec for the exception service can be found in the API Catalog as "LUI Services - Exception Service APIs v1"
But for your convenience I post it here:
<div class="highlight"><pre><span></span><code>curl -X 'POST' \
  'https://api.jdadelivers.com/lui/exception/v1/exceptions' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IlJHYmJjdzhTS05QUEtHRTI0QjZBUjRKZEJvOXJhdTREMHZOeG5OWUxSSzgifQ.eyJpc3MiOiJodHRwczovL2JsdWV5b25kZXJ1cy5iMmNsb2dpbi5jb20vZmEzZTBiNmUtYjJjYy00Njc4LWI4MmItNzIwZWIxOWU3ZDI4L3YyLjAvIiwiZXhwIjoxNjUyOTg1MzQ0LCJuYmYiOjE2NTI5ODE3NDQsImF1ZCI6IjY5YWRiMDRkLTY1OGYtNGI4Ni1hNjU5LTY3ZmUwZjIzYmQxZiIsImVtYWlsIjoiU2ViYXN0aWFuLk5ldWJhdWVyQGJsdWV5b25kZXIuY29tIiwiZ2l2ZW5fbmFtZSI6IlNlYmFzdGlhbiIsImZhbWlseV9uYW1lIjoiTmV1YmF1ZXIiLCJuYW1lIjoiU2ViYXN0aWFuIE5ldWJhdWVyIiwiaWRwX3ByZWZlcnJlZF91c2VybmFtZSI6IjEwMjQwNDdAamRhZGVsaXZlcnMuY29tIiwiaWRwIjoiYzgyNTRhMmEtOTEzYi00Y2Q2LTliNjYtMzM5ZGIzM2RhOGExIiwiYnlfcmVhbG0iOiJieS1kZXZlbG9wZXIiLCJieV9yZWFsbV9pZCI6IjdkYmVhNWJiLTI4YjUtNDA1OS1iZjJhLTViNWJmNmRhZTEwNyIsInRpZCI6ImM5NTM2Njg1LTEyNjItNDIwYi1hOTRiLTRmNTQyMDI4NDY4MCIsInN1YiI6ImMxMGZmYWZmLTcwNjgtNGIzNi1hZWEwLTY4ZWExNzY3NmIwMSIsIm9pZCI6ImMxMGZmYWZmLTcwNjgtNGIzNi1hZWEwLTY4ZWExNzY3NmIwMSIsImJ5X3Njb3BlcyI6WyJieS5pYW0uYWxsIiwiYnkucG9ydGFsLmFsbCIsImJ5LmRwLmFsbCIsImJ5LmxkZS5kZW1hbmRwcmVkaWN0aW9ucyIsImJ5LmxkZS51aSIsImJ5LmxkZS5hbGwiLCJieS5sZXh0LmFsbSJdLCJub25jZSI6IjczMjQzNzQ0LTE4MWUtNDMzOS1iYzJiLWNlZGZjNDY0ZWFmYSIsInNjcCI6ImFjY2VzcyIsImF6cCI6IjFlYzM2YjVlLWY1MzYtNDkzZi1hMDgxLWMyZTk2MjEzZTQ4NyIsInZlciI6IjEuMCIsImlhdCI6MTY1Mjk4MTc0NH0.c-mKcVoqlapCUoEd3nRom5TOLo_vsv0m9VS7W0Ifon7TJrWMw-HcWWngaPxB1rw9Ay36gay_z-YvaDCe9hfsqn2_hbcR5Zu5lvjWj7lD3fXX5Twl-Fo8XqtQbDpomi5QzFjJ_UJmBr1GN6xkEth_eqjdU4hY8BFqX-IYpBHMEBok5spkKBppE7Zf7OD3js2HH7qoEaKoULisD4wRCkNP2lCfZeohpRE1mDUNyo5annp095YRBftN98eWHWjmrYsCXQyDq_oF2hse8_y3tbBmY_Pa0vpa2cBE9heoVyCiH76eMRsGXoeGtZuLaUCNIBptt2lxSUmT9gOI19xFksSw6w' \
  -d '[
  {
    "referenceId": "string",
    "referenceType": "string",
    "source": "string",
    "title": "string",
    "subTitle": "string",
    "description": "string",
    "type": "string",
    "resources": [
      "string"
    ],
    "associatedData": {},
    "extFields": "{}",
    "status": "OPEN",
    "severity": 0,
    "navLink": "string"
  }
]'
</code></pre></div></p>
</div>
<p>Can you do that? 
As there are many people create the same exception, maybe it would be a good idea to include your name in the exception title.</p>
<p>Also, we want to have some information about the newly created prediction override. These sound interestesting: </p>
<ul>
<li><code>'min_affected_date'</code></li>
<li><code>'creation_time'</code></li>
<li><code>'creation_user'</code></li>
</ul>
<p>Do you remember how to embed data from items in strings? Would be handy...</p>
<p>Did you manage to add a working HTTP post request?</p>
<details class="warning">
<summary>Don't worry, the solution here...</summary>
<p>Oh, that got quite long...
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Foreach"</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"Our_filter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">"HTTP"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nt">"inputs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">              </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">"associatedData"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"></span>
<span class="w">                </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Active from: @{items('Process Prediction Overrides')['min_affected_date']}, created: @{items('Process Prediction Overrides')['creation_time']} by @{items('Process Prediction Overrides')['creation_user']}"</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">"extFields"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">"financialImpact"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">"navLink"</span><span class="p">:</span><span class="w"> </span><span class="s2">"navLink"</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">"referenceId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NA"</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">"referenceType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LDE Prediction Overrides"</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">"resources"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                  </span><span class="s2">"resources"</span><span class="w"></span>
<span class="w">                </span><span class="p">],</span><span class="w"></span>
<span class="w">                </span><span class="nt">"severity"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DEVCON"</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">"subTitle"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NA"</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;Your name&gt; Unprocessed Prediction Override"</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Unprocessed Prediction Override"</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">"unitImpact"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">              </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">],</span><span class="w"></span>
<span class="w">            </span><span class="nt">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">              </span><span class="nt">"Authorization"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer @{body('Get LIAM Token')?['access_token']}"</span><span class="p">,</span><span class="w"></span>
<span class="w">              </span><span class="nt">"Content-Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="p">,</span><span class="w"></span>
<span class="w">              </span><span class="nt">"accept"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.jdadelivers.com/lui/exception/v1/exceptions"</span><span class="w"></span>
<span class="w">          </span><span class="p">},</span><span class="w"></span>
<span class="w">          </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"></span>
<span class="w">          </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Http"</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">"expression"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">"and"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">          </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">"greater"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">              </span><span class="s2">"@{ticks(items('Process Prediction Overrides')['creation_time'])}"</span><span class="p">,</span><span class="w"></span>
<span class="w">              </span><span class="s2">"@{ticks(getPastTime(1, 'Minute'))}"</span><span class="w"></span>
<span class="w">            </span><span class="p">]</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">]</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"></span>
<span class="w">      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"If"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">"foreach"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@body('Get Prediction Overrides')"</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"Get Prediction Overrides"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"Succeeded"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div></p>
</details>
<p>Now, a very last thing is missing, we still trigger the workflow manually...but we wanted to run the workflow
based on a trigger every minute.</p>
<p>If you have a look at the global pro-code spec, you will find this section called "triggers"</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">"triggers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">"inputs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nt">"schema"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="nt">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Http"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Request"</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>all we need to do is replace this with a so called recurrent trigger:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">"triggers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">"Recurrence"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">"evaluatedRecurrence"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nt">"frequency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Minute"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="nt">"recurrence"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nt">"frequency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Minute"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Recurrence"</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Woohoo, that's it...let's test it and I will create some new prediction overrides...</p>
<details class="warning">
<summary>Screwed something up on the way...hey, that's software engineering...just copy ;)</summary>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="nt">"definition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">"Get LIAM Token"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Http"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">"inputs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nt">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://login.microsoftonline.com/blueyonderus.onmicrosoft.com/oauth2/v2.0/token"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nt">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">"Content-Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/x-www-form-urlencoded"</span><span class="w"></span>
<span class="w">          </span><span class="p">},</span><span class="w"></span>
<span class="w">          </span><span class="nt">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_id=@{parameters('client_id')}&amp;client_secret=@{parameters('client_secret')}&amp;grant_type=client_credentials&amp;scope=@{parameters('scope')}"</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">"Get Prediction Overrides"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Http"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">"inputs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nt">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.jdadelivers.com/lde/prediction-overrides/v1/overrides?minAffectedDate=2022-05-15"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nt">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">"accept"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">"Authorization"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer @{body('Get LIAM Token')?['access_token']}"</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nt">"Get LIAM Token"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">            </span><span class="s2">"Succeeded"</span><span class="w"></span>
<span class="w">          </span><span class="p">]</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">"Process Prediction Overrides"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Foreach"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nt">"Our_filter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">              </span><span class="nt">"HTTP"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">"inputs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                  </span><span class="nt">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                    </span><span class="p">{</span><span class="w"></span>
<span class="w">                      </span><span class="nt">"associatedData"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"></span>
<span class="w">                      </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Active from: @{items('Process Prediction Overrides')['min_affected_date']}, created: @{items('Process Prediction Overrides')['creation_time']} by @{items('Process Prediction Overrides')['creation_user']}"</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="nt">"extFields"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="nt">"financialImpact"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="nt">"navLink"</span><span class="p">:</span><span class="w"> </span><span class="s2">"navLink"</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="nt">"referenceId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NA"</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="nt">"referenceType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LDE Prediction Overrides"</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="nt">"resources"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                        </span><span class="s2">"resources"</span><span class="w"></span>
<span class="w">                      </span><span class="p">],</span><span class="w"></span>
<span class="w">                      </span><span class="nt">"severity"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DEVCON"</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="nt">"subTitle"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NA"</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;Your name&gt; Unprocessed Prediction Override"</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Unprocessed Prediction Override"</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="nt">"unitImpact"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                  </span><span class="p">],</span><span class="w"></span>
<span class="w">                  </span><span class="nt">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nt">"Authorization"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer @{body('Get LIAM Token')?['access_token']}"</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">"Content-Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">"accept"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="w"></span>
<span class="w">                  </span><span class="p">},</span><span class="w"></span>
<span class="w">                  </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="nt">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.jdadelivers.com/lui/exception/v1/exceptions"</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"></span>
<span class="w">                </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Http"</span><span class="w"></span>
<span class="w">              </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">"expression"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">              </span><span class="nt">"and"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                  </span><span class="nt">"greater"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                    </span><span class="s2">"@{ticks(items('Process Prediction Overrides')['creation_time'])}"</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="s2">"@{ticks(getPastTime(1, 'Minute'))}"</span><span class="w"></span>
<span class="w">                  </span><span class="p">]</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">              </span><span class="p">]</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"></span>
<span class="w">            </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"If"</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="nt">"foreach"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@body('Get Prediction Overrides')"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">"runAfter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nt">"Get Prediction Overrides"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">            </span><span class="s2">"Succeeded"</span><span class="w"></span>
<span class="w">          </span><span class="p">]</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">"contentVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021.1.0.0"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"outputs"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"></span>
<span class="w">    </span><span class="nt">"parameters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">"client_id"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">"defaultValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"String"</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">"client_secret"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">"defaultValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"String"</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">"scope"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">"defaultValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"String"</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">"triggers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">"Recurrence"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">"evaluatedRecurrence"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nt">"frequency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Minute"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="nt">"recurrence"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nt">"frequency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Minute"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Recurrence"</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">"parameters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"client_id"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"----myid-----"</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">"client_secret"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-----my secret------"</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">"scope"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://blueyonderus.onmicrosoft.com/69adb04d-658f-4b86-a659-67fe0f23bd1f/.default"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</details>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: The Story" class="md-footer__link md-footer__link--prev" href="../story/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              The Story
            </div>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.instant", "navigation.sections", "toc.integrate"], "search": "../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
<script src="../assets/javascripts/bundle.ed9748b7.min.js"></script>
</body>
</html>